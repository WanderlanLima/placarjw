<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Placar JW</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icon-192.png?v=2">
    <meta name="theme-color" content="#121212">
    <!-- Google Fots -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <header>
        <button id="back-btn" onclick="app.goBack()">&#8592;</button>
        <h1 id="page-title">Placar Esportivo</h1>
        <div style="display: flex; gap: 10px;">
            <button id="fullscreen-btn" onclick="app.toggleFullscreen()">‚õ∂</button>
            <button id="theme-btn" onclick="app.toggleTheme()">üåô</button>
        </div>
    </header>

    <div id="app">

        <!-- MAIN MENU -->
        <div id="menu-view" class="view active">
            <div class="menu-card" onclick="app.navigateTo('volleyball')">
                <span class="card-icon">üèê</span>
                <h2>V√¥lei</h2>
                <p>Sets, Pontos e Rod√≠zio</p>
            </div>

            <div class="menu-card" onclick="app.navigateTo('futsal')">
                <span class="card-icon">‚öΩ</span>
                <h2>Futsal</h2>
                <p>Gols, Faltas e Cron√¥metro</p>
            </div>
        </div>

        <!-- VOLLEYBALL BOARD -->
        <div id="volleyball-view" class="view">
            <div class="scoreboard">
                <div class="top-bar-controls">
                    <button class="control-btn-small" onclick="volleyball.undo()">‚Ü©Ô∏è Desfazer</button>
                </div>
                <div class="sets-display" style="justify-content: center; padding: 10px;">
                    Sets: <span id="v-sets-a">0</span> - <span id="v-sets-b">0</span>
                </div>

                <div class="score-area">
                    <div class="team-column" id="v-team-a">
                        <span class="team-name" onclick="app.editName(this)">Time A ‚úèÔ∏è</span>
                        <button class="score-btn" onclick="volleyball.addPoint('a')">0</button>
                        <div class="controls">
                            <button class="control-btn minus" onclick="volleyball.remPoint('a')">-1</button>
                        </div>
                    </div>

                    <div class="team-column" id="v-team-b">
                        <span class="team-name" onclick="app.editName(this)">Time B ‚úèÔ∏è</span>
                        <button class="score-btn" onclick="volleyball.addPoint('b')">0</button>
                        <div class="controls">
                            <button class="control-btn minus" onclick="volleyball.remPoint('b')">-1</button>
                        </div>
                    </div>
                </div>

                <div class="controls">
                    <button class="control-btn" onclick="volleyball.resetGame()">Novo Jogo</button>
                </div>
            </div>
        </div>

        <!-- FUTSAL BOARD -->
        <div id="futsal-view" class="view">
            <div class="scoreboard">
                <div class="top-bar-controls">
                    <button class="control-btn-small" onclick="futsal.undo()">‚Ü©Ô∏è Desfazer</button>
                </div>
                <div class="timer-container">
                    <div id="f-timer" class="timer paused" onclick="futsal.toggleTimer()">10:00</div>
                    <div style="display: flex; gap: 10px; margin-top: 5px;">
                        <small style="color: grey;" onclick="futsal.toggleTimer()">Toque para Iniciar</small>
                        <span style="color: #333">|</span>
                        <small style="color: var(--primary-color); cursor: pointer;" onclick="futsal.setTime()">‚è±Ô∏è Mudar
                            Tempo</small>
                    </div>
                </div>

                <div class="score-area">
                    <div class="team-column">
                        <span class="team-name" onclick="app.editName(this)">Casa ‚úèÔ∏è</span>
                        <button class="score-btn" onclick="futsal.addGoal('a')">0</button>
                        <div class="controls">
                            <button class="control-btn minus" onclick="futsal.remGoal('a')">-1</button>
                        </div>
                        <div style="margin-bottom: 10px; color: #ff3d00;">
                            Faltas: <span id="f-fouls-a">0</span> <button class="control-btn"
                                style="padding: 2px 8px; font-size: 0.8rem;" onclick="futsal.addFoul('a')">+</button>
                        </div>
                    </div>

                    <div class="team-column">
                        <span class="team-name" onclick="app.editName(this)">Visitante ‚úèÔ∏è</span>
                        <button class="score-btn" onclick="futsal.addGoal('b')">0</button>
                        <div class="controls">
                            <button class="control-btn minus" onclick="futsal.remGoal('b')">-1</button>
                        </div>
                        <div style="margin-bottom: 10px; color: #ff3d00;">
                            Faltas: <span id="f-fouls-b">0</span> <button class="control-btn"
                                style="padding: 2px 8px; font-size: 0.8rem;" onclick="futsal.addFoul('b')">+</button>
                        </div>
                    </div>
                </div>

                <div class="controls">
                    <button class="control-btn" onclick="futsal.resetGame()">Novo Jogo</button>
                </div>
            </div>
        </div>

    </div>

    <!-- Custom Modal -->
    <div id="custom-modal" class="modal-overlay">
        <div class="modal-content">
            <h3 id="modal-msg">Tem certeza?</h3>
            <div class="modal-actions">
                <button class="modal-btn cancel" onclick="app.closeModal()">Cancelar</button>
                <button id="modal-confirm-btn" class="modal-btn confirm">Sim</button>
            </div>
        </div>
    </div>

    <!-- Custom Input Modal -->
    <div id="input-modal" class="modal-overlay">
        <div class="modal-content">
            <h3 id="input-modal-msg">Digite:</h3>
            <input type="number" id="input-modal-field" class="modal-input" inputmode="numeric" />
            <div class="modal-actions">
                <button class="modal-btn cancel" onclick="app.closeInputModal()">Cancelar</button>
                <button id="input-modal-confirm-btn" class="modal-btn confirm">OK</button>
            </div>
        </div>
    </div>

    <!-- Update Notification -->
    <div id="update-toast" class="update-toast">
        <span>Nova vers√£o dispon√≠vel!</span>
        <button onclick="window.location.reload()">Atualizar</button>
    </div>

    <!-- Scripts -->
    <script src="modules/volleyball.js"></script>
    <script src="modules/futsal.js"></script>
    <script src="app.js"></script>
    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js').then(reg => {
                console.log('SW Registered!', reg);

                // Check if there's an update waiting
                if (reg.waiting) {
                    showUpdateToast();
                }

                reg.addEventListener('updatefound', () => {
                    const newWorker = reg.installing;
                    newWorker.addEventListener('statechange', () => {
                        if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                            showUpdateToast();
                        }
                    });
                });
            }).catch(err => console.log('SW Failed', err));
        }

        function showUpdateToast() {
            const toast = document.getElementById('update-toast');
            if (toast) toast.classList.add('active');
        }
    </script>
</body>

</html>